Act칰a como un Desarrollador Senior de Backend y Arquitecto de Software experto en motores de n칩mina (Payroll) y bases de datos SQLAlchemy.

Tu objetivo es implementar la funcionalidad de "Conceptos Prorrateables por Asistencia" en nuestro ERP de planillas, asegurando 100% de retrocompatibilidad con las planillas cerradas hist칩ricas y SIN alterar la l칩gica existente de "Ajustes de Auditor칤a".

Para lograr esto, ciertos conceptos din치micos ingresados por su valor nominal (ej. Movilidad) deben multiplicarse por un factor de asistencia si el usuario los marca como prorrateables en el Maestro de Conceptos. Adicionalmente, el monto descontado por la inasistencia debe sumarse exclusivamente a la proyecci칩n anual de la Renta de 5ta Categor칤a para evitar distorsiones tributarias.

DEBES MODIFICAR ESTRICTAMENTE LOS SIGUIENTES 4 ARCHIVOS, no debes alterar ninguna funci칩n adicional de la aplicaci칩n y debes respetar las instrucciones paso a paso:

1. Modificar `infrastructure/database/models.py`:
- En la clase `Concepto`, a침ade el siguiente campo:
  `prorrateable_por_asistencia = Column(Boolean, default=False)`

2. Modificar `presentation/app.py`:
- En la lista `_migraciones` (dentro del bloque "AUTO-CREAR TABLAS EN NEON"), a침ade la sentencia SQL para actualizar la BD de forma segura:
  `"ALTER TABLE conceptos ADD COLUMN IF NOT EXISTS prorrateable_por_asistencia BOOLEAN DEFAULT false",`

3. Modificar `presentation/views/maestro_conceptos.py`:
- En la Secci칩n A (generaci칩n de la lista `rows` para el DataFrame de edici칩n r치pida), agrega:
  `"Prorrateable (Asist.)": getattr(c, 'prorrateable_por_asistencia', False),`
- En el `st.data_editor`, dentro de `column_config`, a침ade:
  `"Prorrateable (Asist.)": st.column_config.CheckboxColumn(),`
- En la l칩gica de guardado de esa misma tabla (`if st.button("游 Guardar Cambios de Afectaciones"...`), actualiza el objeto:
  `c.prorrateable_por_asistencia = bool(row.get("Prorrateable (Asist.)", False))`
- En la Secci칩n B ("Editar Concepto", col_der), a침ade el checkbox debajo del de gratificaci칩n:
  `prorrateable_edit = st.checkbox("Prorrateable por asistencia", value=bool(getattr(obj_editar, 'prorrateable_por_asistencia', False)), key="e_cb_pror")`
  Y aseg칰rate de guardarlo en el objeto `obj_editar` cuando se presione el bot칩n de actualizar.
- En la Pesta침a 2 ("Nuevo Concepto", col2), a침ade el checkbox:
  `comp_pror = st.checkbox("Prorrateable por asistencia", value=False, key="cb_pror")`
  Y aseg칰rate de incluir `prorrateable_por_asistencia=comp_pror` en la instanciaci칩n de `Concepto(...)` en el `db.add()`.

4. Modificar `presentation/views/calculo_mensual.py` (춰MOTOR CR칈TICO!):
- En la funci칩n `_cargar_conceptos_df(db, empresa_id)`, a침ade al diccionario que se appendea a `rows`:
  `"Prorrateable": getattr(c, 'prorrateable_por_asistencia', False),`
- En la funci칩n `_render_planilla_tab()`, justo antes de la l칤nea `elif st.button(f"游 Ejecutar Motor de Planilla...`, a침ade un banner informativo para el usuario:
  `st.info("游눠 **Novedad:** Ahora puedes configurar qu칠 conceptos din치micos (ej. Movilidad) se reducen autom치ticamente por faltas desde el **Maestro de Conceptos**.")`
- Dentro del bucle principal del motor (`for index, row in df_planilla.iterrows():`):
  A) Inmediatamente despu칠s de definir `dias_laborados` y `dias_computables`, calcula el factor de asistencia:
     `factor_asistencia = dias_laborados / dias_computables if dias_computables > 0 else 0.0`
  B) Antes del bucle `for _, concepto in conceptos_empresa.iterrows():`, inicializa la variable acumuladora:
     `conceptos_recuperados_5ta = 0.0`
  C) Dentro de ese bucle `for _, concepto in conceptos_empresa.iterrows():`, reemplaza la l칤nea `monto_concepto = float(row[nombre_c])` por la siguiente l칩gica de prorrateo:
     ```python
     monto_ingresado_nominal = float(row[nombre_c])
     if concepto.get('Prorrateable', False):
         monto_concepto = monto_ingresado_nominal * factor_asistencia
         # Si es un ingreso afecto a 5ta, guardamos el diferencial que se perdi칩 por faltar
         if concepto['Tipo'] == "INGRESO" and concepto.get('Afecto 5ta Cat.', False):
             conceptos_recuperados_5ta += (monto_ingresado_nominal - monto_concepto)
     else:
         monto_concepto = monto_ingresado_nominal
     ```
     (Aseg칰rate de que las l칤neas que siguen dentro de este bloque `if` utilicen `monto_concepto` y no modifiques NADA de la secci칩n posterior de "Ajustes de Auditor칤a" ni de las variables `_ajuste_afp`, etc. Esas deben quedar intactas).
  D) En la secci칩n "RENTA 5TA CATEGOR칈A", donde se define `base_quinta_proyeccion`:
     Cambia la l칤nea:
     `base_quinta_proyeccion = round(base_quinta_mes + (sueldo_base_nominal - sueldo_computable), 2)`
     Por:
     `base_quinta_proyeccion = round(base_quinta_mes + (sueldo_base_nominal - sueldo_computable) + conceptos_recuperados_5ta, 2)`

Revisa cuidadosamente la indentaci칩n en `calculo_mensual.py` ya que es un script extenso. No uses m칠todos destructivos, utiliza `getattr` y `.get()` para proteger diccionarios antiguos. Realiza los cambios y haz commit.